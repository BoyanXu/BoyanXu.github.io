# Lecture2: Dynamic Web Programming with Python
#web编程
## Flask Framework
1. Set up
```
export FLASK_APP=application.py
run flask
```
2. @app.route(“/”)
```
@app.route(“/”)
def function(){
    return “<h1>title</h1>”
}
```
Then you can bind functions to a specific url.
3. `@app.route(“/<string:name>”)`
The input url will serve as variable `name`, for later operations.
Then we created a dynamic website.
4. `render_template(“Index.html”)` 
Render a html file, immediately in the director `template`
`render_template(“index.html, VARIABLE_NAME”)`
Within the html template, use`{{VARIABLE_NAME}}` to create a holder for variable to be passed in.
Within the @route{} function, call 
`render_template(“index.html, VARIABLE_NAME”)` to pass variable to the html template.
5. Is it Christmas? （Conditional Statement）
http://isitchristmas is an example of dynamically generating webpage content, based on different conditions.
In the application.py, simply add if-statement to the `@route(“/”)function`, and return different variable to the template, by
 ` return render_template(index.html,VARIABLE)`.
     
In the template html file, use the following syntax to express the corresponding syntax:
```
{%if BOOLEAN_VARIABLE%}
    <p>...</p>
{%else%}
    <p>...</p>
{%elif BOOLEAN_VARIABLE%}
    <p>...</p>
```
(I want to conditionally use html elements based on such rule⬆️)
6. Recursion Statement
You can pass list containing a bunch of strings to the template html file.
And use the following syntax to loop with that list variable:
```
{% for item in list %}
        <html elements>
{% endfor %}
```
7. Link to another page `<a href={{  url_for( ‘FUNCTION_NAME’ ) }} >`
Create hyperlink pointing insite pages.
8. Template inheritance
`layout.html` template file serve as a father template, with `{ % block heading %}`  and `{% endblock %}`as a block holder for the child pages to fill in. 
`child.html` template file has the following syntax, consisting the block holder’s tag name, to finally inherit the `layout.html` :
```
{% extend “layout.html” %}
{% block header %}
<h1> headerheaderheaderheaderheaderheaderheaderheaderheaderheader
</h1>
{% endblock %}
{% block paragragh1 %}
<p> paragraphparagraphparagraphparagraphparagraphparagraphparagraphparagraphparagraphparagraphparagraphparagraphparagraphparagraph </p>
{% endblock %}
{% block paragrapgh2 %}
<p>
paragraphparagraphparagraphparagraphparagraphparagraphparagraphparagraphparagraphparagraphparagraphparagraphparagraphparagraph
</p>
{% endblock %}
```
9. <form> and response to the <form>
In the `form.html` template：
```
<form action=“{{url_for(‘hello’) method=“post”}} ”>
<input type=“text” name=“user_name” placeholder=“Enter your name” >
<button>Submit<button>
</form>
```
The form element’s property`action = “ {{ url_for(‘hello’) }} ”`  indicates that the submitted form will at the same time call the function  
```
@app.route(“/hello”, methods=[“POST”])
def hello():
    name = request.form.get(“user_name”)
    return(render_template(“hello.html”, name))
```
to build another webpage (url=“/hello” )
`GET`and `POST` are methods of requesting webpage
The form element’s property`method=“post”` indicates that after submitting the form, calling function `hello` within the application.py, and rendering the webpage “hello”, **browser’s method of jumping to webpage“hello”, it’s way of accessing the page “hello” is POST, rather than POST**
Once form is submitted, the web browser jumps to `hello.html`, generated by calling the function 
```
@app.route(“/hello”, methods=[“POST”])
def hello():
    name = request.form.get(“user_name”)
    return(render_template(“hello.html”, name))
```
For the function hello() within application.py:
```
@app.route(“/hello”, methods=[“POST”])
def hello():
    name = request.form.get(“user_name”)
    return(render_template(“hello.html”, name))
```
`methods=[POST]`indicating that people gonna  accessing this website by POST rather than GET,(post information to the website). _At the time, if we directly access the website“_/hello” by the url rather than jumping from form’s page, we won’t be allowed to generate the page content through `hello()`/
`request` collect whatever request user made to the server.
request.form.get(`“user_name”`) represents get the form whose name attribute is `“user_name”`.
+++
Why using POST to jump from webpage (built by template`form.html`) to webpage (built by template`hello.html`)
    1. f we jump by GET, the info you filled in the form will show up in the searching bar on the top of web browser. (like ‘“hello?password=1234567”’)
    2. Form sometimes requires user to input sensitive info, like their password. 
+++
10. Session (User-Spec)
(Store all user data in the server, and only distribute user-specific dat to the user.)
Dependency: `flask.session`,or `flask_session.Session`(which make server-side management easier?)
Set up:
```
app = flask(__name__)
app.config[“SESSION_PERMISSION”] = False
app.config[“SESSION_TYPE”] = “filesystem”
flask_session.Session(app)
```
If you want to create “user-specific variable” whose data is user-specific, you use the `flask.session[VARIABLE_NAME]` to initialize and operate the user specific variable, like`Session`
Session recognize user by the cookie info of their browser.
